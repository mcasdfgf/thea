# schema.yaml: Defines the "constitution" of the UniversalMemory.
# It specifies the allowed types of nodes and edges, along with their intended purpose.

node_types:
  # --- Experience Nodes ---
  UserImpulse:
    description: "The raw, unprocessed input from the user."
  InstinctiveResponseNode:
    description: "The initial, 'instinctive' LLM response, generated without memory access."
  FinalResponseNode:
    description: "The final, synthesized response delivered to the user."

  # --- Cognitive Process Nodes ---
  SearchPlanNode:
    description: "A plan of search actions, generated by the EnrichmentPlannerService."
  TaskNode:
    description: "A task assigned to a cognitive service by the Orchestrator."
  ReportNode:
    description: "A report from a cognitive service, detailing the result of a task."
  
  # --- Knowledge Nodes ---
  ConceptNode:
    description: "A key entity or 'semantic atom' extracted from an experience."
  KnowledgeCrystalNode:
    description: "An insight, representing a synthesized piece of knowledge derived from experience."
    attributes:
      state: { type: string, default: "UNVERIFIED" } # Note: 'state' is legacy, use 'active_status' and 'strength' instead.
  ThemeNode:
    description: "A high-level theme that semantically groups multiple insights."

  # --- Web Search Nodes (Legacy/Future Use) ---
  DailyResearchLogNode: 
    description: "A log for daily research activities (future use)."
  ResearchNode: 
    description: "Container for a specific research task (future use)."
  QueryNode: 
    description: "A specific query sent to an external search engine (future use)."
  SourceNode: 
    description: "A URL or source document found by web search (future use)."
  FactNode:
    description: "An atomic piece of information, often from an external source or user command."
    attributes:
      verification_status: { type: string, default: "UNVERIFIED" }

  # --- Archival & Finetuning Nodes ---
  DialogueTurnNode:
    description: "An archived user-assistant turn, containing a distilled summary. Used for creating finetuning datasets."
      
edge_types:
  # --- Core Cognitive Cycle Edges ---
  IS_INSTINCT_FOR:
    description: "Links an instinctive response to the user impulse that triggered it."
  GENERATED_SEARCH_PLAN: # This seems to be unused in the current logic, CONTAINS_PLAN is used instead.
    description: "Links a search plan to the cognitive step that generated it."
  WAS_SYNTHESIZED_USING:
    description: "Links the final response to the nodes (instinct, reports) used in its synthesis."
  BASED_ON_MEMORY:
    description: "Indicates that a final response was influenced by a specific past memory node."
  IS_RESPONSE_TO:
    description: "Links a final response node back to the original user impulse."

  # --- General Process & Knowledge Edges ---
  IS_TASK_FOR:
    description: "Links a task to the node it operates on."
  IS_RESULT_OF:
    description: "Links a report to the task that produced it."
  CONTAINS_CONCEPT:
    description: "Links an experience node (e.g., UserImpulse) to an extracted concept."
  INSIGHT_FROM_CONCEPT:
    description: "Links a KnowledgeCrystal to a concept it is based on."
  SUPERSEDES:
    description: "Links a new, stronger insight to an older one it replaces."
  PART_OF_THEME:
    description: "Links an insight to a high-level theme."
  
  # --- Fact & Source Edges ---
  SOURCED_FROM:
    description: "Links a fact or piece of knowledge to its origin (e.g., another node, a URL)."
  HAS_RESEARCH:
    description: "Links a primary node to its associated research activities."
  USED_QUERY:
    description: "Links a research node to the specific search query used."
  FOUND_SOURCE:
    description: "Links a query node to the source it discovered."
  CONTAINS_FACT:
    description: "Links a source to the facts extracted from it."
