# 5. Когнитивные Зонды

**Модуль:** `nexus_tools/cmd_probes.py`
**Команды в `Nexus`:** `plan`, `probe`

## Назначение

Когнитивные зонды — это инструменты для изолированного тестирования ключевых мыслительных циклов системы без запуска полного, ресурсоемкого ядра. Они позволяют быстро отлаживать и настраивать промпты, а также проверять работу поисковых механизмов.

Все зонды работают **исключительно с LLM и модулями `Nexus`**, не требуя запущенного `main.py` или `orchestrator.py`.

> ⚠️ **Примечание для Демо-версии:** Команды plan и probe эмулируют "живые" мыслительные процессы системы и требуют доступа к полному коду когнитивного ядра (включая сервисы и LLM-интерфейс). В данном демо-репозитории, предназначенном для анализа уже созданного "слепка памяти", эти команды отключены.

## Команда `plan`

Зонд `plan` позволяет протестировать первую, самую важную часть когнитивного цикла: **"Инстинкт -> План Обогащения"**. Он показывает, как система реагирует на запрос пользователя и какие поисковые запросы она формирует для обращения к своей памяти.

### Использование
```
[NEXUS]> plan "<ТекстИмпульса>" [--history <ПутьКФайлу>]
```
-   `<ТекстИмпульса>`: Текст запроса пользователя, который вы хотите протестировать. Обязательно заключайте в кавычки.
-   `--history <ПутьКФайлу>` (опциональный): Путь к `.json` файлу, содержащему историю диалога. Это позволяет проверить, как система учитывает контекст.

### Что показывает результат?
Вывод разделён на два этапа:
1.  **`Step 1: Instinct Generation`**: Показывает быстрый, "инстинктивный" ответ, сгенерированный `SimpleExecutorService`. Это то, что система "подумала" в первую очередь.
2.  **`Step 2: Enrichment Planning`**: Демонстрирует результат работы `EnrichmentPlannerService`. Здесь вы видите финальный JSON-план с `semantic_query` и `concepts` — это именно те запросы, которые система отправит в свою долговременную память для обогащения ответа.

## Команда `probe`

Зонд `probe` предназначен для прямого тестирования механизмов поиска в памяти и для эмуляции полного цикла ответа.

### Использование
```
[NEXUS]> probe <режим> "<запрос>"
```
-   `<режим>`: Указывает, что именно нужно протестировать.
-   `<запрос>`: Поисковый запрос или импульс, заключенный в кавычки.

### Режимы Работы

#### `probe memory "<запрос>"`
**Прямой тест поиска в памяти.** Этот режим напрямую вызывает `MemoryRecallService` с вашим запросом.
-   **Что происходит:** Выполняется полный цикл поиска (семантический, по концептам), ранжирование результатов и синтез итоговой сводки из найденных в памяти фрагментов.
-   **Когда использовать:** Для проверки качества работы `MemoryRecallService`, тюнинга весов ранжирования и анализа релевантности найденных узлов.

#### `probe full "<запрос>"`
**Эмуляция полного когнитивного цикла.** Этот режим имитирует всю цепочку, которую проходит система для ответа пользователю.
-   **Что происходит:** Последовательно выполняются все четыре шага:
    1.  **Instinct:** Генерация быстрого ответа.
    2.  **Enrichment Plan:** Создание плана поиска.
    3.  **Memory Recall:** Выполнение поисковых запросов к памяти.
    4.  **Final Synthesis:** Сборка финального ответа на основе инстинкта и найденных в памяти данных.
-   **Когда использовать:** Для комплексной, end-to-end проверки всего мыслительного процесса в контролируемой среде.
